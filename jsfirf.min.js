function jsfirf(t,i,s,r){"use strict";this.smp_freq=t,this.trans_freq=i,this.order=s,this.order%2==1&&this.order++,this.win_type=void 0===r?"rectangular":r,this.frq_ratio=i/t,this.nmax=this.order/2,this.nmin=-1*this.nmax,this.set_window(),this.set_weights(),this.set_taps()}jsfirf.prototype.set_window=function(){"use strict";var t;if(this.win_weights=[],"rectangular"==this.win_type)for(t=0;t<=this.order;t++)this.win_weights.push(1);else if("bartlett"==this.win_type)for(t=0;t<=this.order;t++)this.win_weights.push(1-2*Math.abs(t-this.nmax)/this.order);else if("hanning"==this.win_type)for(t=0;t<=this.order;t++)this.win_weights.push(.5-.5*Math.cos(2*Math.PI*t/this.order));else if("hamming"==this.win_type)for(t=0;t<=this.order;t++)this.win_weights.push(.54-.46*Math.cos(2*Math.PI*t/this.order));else if("blackman"==this.win_type)for(t=0;t<=this.order;t++)this.win_weights.push(.42-.5*Math.cos(2*Math.PI*t/this.order)+.08*Math.cos(4*Math.PI*t/this.order))},jsfirf.prototype.set_weights=function(){"use strict";var t;this.weights=[];var i=this.trans_freq/this.smp_freq;for(t=this.nmin;t<=this.nmax;t++)0==t?this.weights.push(2*i):this.weights.push(Math.sin(2*Math.PI*i*t)/(Math.PI*t))},jsfirf.prototype.set_taps=function(){"use strict";var t;for(this.taps=[],t=this.nmin;t<=this.nmax;t++)this.taps.push(this.win_weights[t-this.nmin]*this.weights[t-this.nmin])},jsfirf.prototype.unity=function(){"use strict";var t;for(this.taps=[],t=this.nmin;t<=this.nmax;t++)0==t?this.taps.push(1):this.taps.push(0)},jsfirf.prototype.set_val=function(t,i,s,r){"use strict";var e,n=Math.pow(2,8*s-1),a=Math.abs(r);e=a>n?r/(a+1)*n:r,1==s?t.setInt8(i,e):2==s?t.setInt16(i<<1,e):4==s&&t.setInt32(i<<2,e)},jsfirf.prototype.get_val=function(t,i,s){"use strict";var r;return 1==s?r=t.getInt8(i):2==s?r=t.getInt16(i<<1):4==s&&(r=t.getInt32(i<<2)),r},jsfirf.prototype.get_array=function(t,i){"use strict";for(var s,r=[],e=0;e<t.byteLength;e+=i)1==i?s=t.getInt8(e):2==i?s=t.getInt16(e):4==i&&(s=t.getInt32(e)),r.push(s);return r},jsfirf.prototype.chunk=function(t,i,s,r,e,n,a,h,o){var f=this;return function(){f.apply_piece(t,i,s,r,e),a(h,o),null!=n&&setTimeout(n,10)}},jsfirf.prototype.nb_cb=function(t,i){return function(){i(t.buffer)}},jsfirf.prototype.apply_chain=function(t,i,s,r,e,n,a){for(var h,o,f=parseInt(t/20),p=this.nb_cb(s,e),u=this.chunk(0,f,i,s,r,p,n,a,100),w=f;w<t;w+=f)(o=w+f)>t&&(o=t),u=h=this.chunk(w,o,i,s,r,u,n,a,Math.round(100-w/t*100));return h},jsfirf.prototype.apply_piece=function(t,i,s,r,e){for(var n=t;n<i;n++){if(result=0,tapmax=this.order,n<this.order)result=0;else for(var a=0;a<=tapmax;a++)result+=this.taps[a]*this.get_val(s,n-tapmax+a,e);this.set_val(r,n,e,result)}},jsfirf.prototype.apply_nb=function(t,i,s,r,e){"use strict";var n=new ArrayBuffer(t.byteLength),a=new DataView(t),h=new DataView(n),o=i/8,f=t.byteLength/o;return this.apply_chain(f,a,h,o,s,r,e)(),n},jsfirf.prototype.apply=function(t,i){"use strict";for(var s,r,e=new ArrayBuffer(t.byteLength),n=new DataView(t),a=new DataView(e),h=i/8,o=t.byteLength/h,f=0;f<o;f++){if(s=0,r=this.order,f<this.order)s=0;else for(var p=0;p<=r;p++)s+=this.taps[p]*this.get_val(n,f-r+p,h);this.set_val(a,f,h,s)}return e},jsfirf.prototype.lopass=function(t,i,s){"use strict";var r=this.smp_freq,e=this.order,n=this.win_type;return void 0===r?[]:(void 0===e&&(e=20),void 0===n&&(n="rectangular"),new jsfirf(r,i,e,n).apply(t,s))},jsfirf.prototype.hipass=function(t,i,s){"use strict";var r=this.smp_freq,e=this.order,n=this.win_type;if(void 0===r)return[];void 0===e&&(e=20),void 0===n&&(n="rectangular");var a=new jsfirf(r,i,e,n),h=new jsfirf(r,i,e,n);h.unity();for(var o,f=a.apply(t,s),p=h.apply(t,s),u=new DataView(f),w=new DataView(p),c=new ArrayBuffer(t.byteLength),_=new DataView(c),y=s/8,v=f.byteLength/y,l=0;l<v;l++)o=this.get_val(w,l,y)-this.get_val(u,l,y),this.set_val(_,l,y,o);return c},jsfirf.prototype.bandpass=function(t,i,s,r){"use strict";var e=this.smp_freq,n=this.order,a=this.win_type;if(void 0===e)return[];void 0===n&&(n=20),void 0===a&&(a="rectangular");var h=this.hipass(t,i,r);return this.lopass(h,s,r)},jsfirf.prototype.lopass_nb=function(t,i,s,r,e,n){"use strict";var a=this.smp_freq,h=this.order,o=this.win_type;if(void 0===a)return[];void 0===h&&(h=20),void 0===o&&(o="rectangular"),new jsfirf(a,i,h,o).apply_nb(t,s,r,e,n)},jsfirf.prototype.hipass_nb=function(t,i,s,r,e,n){"use strict";var a=this.smp_freq,h=this.order,o=this.win_type;if(void 0===a)return[];void 0===h&&(h=20),void 0===o&&(o="rectangular");var f=new jsfirf(a,i,h,o),p=new jsfirf(a,i,h,o);p.unity();var u,w=this,c=function(){p.apply_nb(t,s,_,e,n)},_=function(i){for(var e,n=i,a=new DataView(u),h=new DataView(n),o=new ArrayBuffer(t.byteLength),f=new DataView(o),p=s/8,c=u.byteLength/p,_=0;_<c;_++)e=w.get_val(h,_,p)-w.get_val(a,_,p),w.set_val(f,_,p,e);r(o)};f.apply_nb(t,s,function(t){u=t,c()},e,n)},jsfirf.prototype.bandpass_nb=function(t,i,s,r,e,n,a){"use strict";var h=this.smp_freq,o=this.order,f=this.win_type;if(void 0===h)return[];void 0===o&&(o=20),void 0===f&&(f="rectangular");var p=this;p.hipass_nb(t,i,r,function(t){p.lopass_nb(t,s,r,e,n,a)},n,a)};